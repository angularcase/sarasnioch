<app-page-content [title]="product()?.name ?? 'Produkt'" [breadcrumbs]="breadcrumbs()">
    @if (loading()) {
        <p class="text-surface-600 dark:text-surface-300">Pobieranie produktu...</p>
    } @else if (product(); as prod) {
        <div class="grid grid-cols-1 md:grid-cols-[40fr_60fr] gap-6 md:gap-8">
            <div class="flex flex-col gap-6 order-1 md:order-1">
                <app-atom-grey-box [title]="'Producent'">
                    @if (hasManufacturerWebsite(prod)) {
                        <div slot="body">
                            <a [href]="getManufacturerWebsite(prod)!" target="_blank" rel="noopener noreferrer" class="text-surface-600 dark:text-surface-400 hover:text-surface-900 dark:hover:text-surface-0 transition-colors">
                                {{ getManufacturerDisplay(prod) }}<span class="text-xs"> ({{ getManufacturerWebsite(prod) }})</span>
                            </a>
                        </div>
                    } @else {
                        <p slot="body" class="text-surface-600 dark:text-surface-400 text-base leading-normal">{{ getManufacturerDisplay(prod) }}</p>
                    }
                </app-atom-grey-box>
                @if (hasLeaflets(prod)) {
                    <div class="hidden md:block">
                        <app-atom-grey-box [title]="'Do pobrania'">
                            <div slot="body" class="flex flex-wrap gap-2">
                                @for (leaflet of getLeaflets(prod); track leaflet.id) {
                                    <a [href]="leaflet.file.url" target="_blank" [download]="leaflet.file.name"
                                       class="inline-flex items-center gap-2 px-3 py-2 rounded-lg
                                              bg-primary-50 dark:bg-primary-900/30
                                              text-primary-700 dark:text-primary-200
                                              hover:bg-primary-100 dark:hover:bg-primary-800/50
                                              transition-colors text-sm font-medium">
                                        <i class="pi pi-download text-sm"></i>
                                        <span>{{ leaflet.caption }}</span>
                                    </a>
                                }
                            </div>
                        </app-atom-grey-box>
                    </div>
                }
                @if (getFirstImageUrl(prod); as imageUrl) {
                    <app-atom-grey-box [title]="''">
                        <img [src]="imageUrl" [alt]="prod.name" class="w-full h-auto rounded-lg object-contain" />
                    </app-atom-grey-box>
                }
            </div>
            <div class="flex flex-col gap-6 min-w-0 order-2 md:order-2">
                <div class="flex flex-wrap gap-2">
                    @for (cat of prod.animalCategories ?? []; track cat.slug) {
                        <app-atom-badge variant="category" [label]="cat.name" [routerLink]="'/produkty/' + cat.slug" />
                    }
                </div>
                @if (prod.description) {
                    <div class="text-base text-surface-700 dark:text-surface-300 prose dark:prose-invert max-w-none" [innerHTML]="typeof prod.description === 'string' ? prod.description : ''"></div>
                }
                @if (hasLeaflets(prod)) {
                    <div class="block md:hidden">
                        <app-atom-grey-box [title]="'Do pobrania'">
                            <div slot="body" class="flex flex-wrap gap-2">
                                @for (leaflet of getLeaflets(prod); track leaflet.id) {
                                    <a [href]="leaflet.file.url" target="_blank" [download]="leaflet.file.name"
                                       class="inline-flex items-center gap-2 px-3 py-2 rounded-lg
                                              bg-primary-50 dark:bg-primary-900/30
                                              text-primary-700 dark:text-primary-200
                                              hover:bg-primary-100 dark:hover:bg-primary-800/50
                                              transition-colors text-sm font-medium">
                                        <i class="pi pi-download text-sm"></i>
                                        <span>{{ leaflet.caption }}</span>
                                    </a>
                                }
                            </div>
                        </app-atom-grey-box>
                    </div>
                }
            </div>
        </div>
    }
</app-page-content>
